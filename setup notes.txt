
FROM debian:stable-slim

ARG BUILDNODE=unspecified
ARG SOURCE_COMMIT=unspecified
ARG contentServer=content.lacledeslan.net

# Install dependencies
RUN apt-get update &&`
    apt-get install -y `
        bzip2 ca-certificates curl lib32gcc1 p7zip-full tar unzip wget &&`
    apt-get clean &&`
rm -rf /tmp/* /var/lib/apt/lists/* /var/tmp/*;

RUN echo $'\n\nGettinhg base game' &&`

mkdir /app
cd /app
wget http://sebastian.network/warsow/warsow-2.1.2.tar.gz
tar -zxvf warsow-2.1.2.tar.gz

cd/app/warsow-2.1.2/ 

RUN echo $'\n\nDownloading LL custom content from content server' &&`
       wget wget -rkpN -nH --cut-dirs=2 -e robots=off --no-parent --reject "index.html*" http://content.lacledeslan.net/fastDownloads/warsow/ /app/warsow-2.1.2 &&`

cd /


# Add in tests
COPY /ll-tests /app/ll-tests

RUN echo $'\n\nGetting LL config' &&`
weget https://github.com/LacledesLAN/gamesvr-warsow/archive/master.zip
unzip master.zip -d /app/warsow-2.1.2
